% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/km_wlr_calculations_helpers.R
\name{wlr_dhat_estimates}
\alias{wlr_dhat_estimates}
\title{Weighted Log-Rank and Difference Estimate at a Specified Time}
\usage{
wlr_dhat_estimates(
  dfcounting,
  scheme = "fh",
  scheme_params = list(rho = 0, gamma = 0),
  tzero = NULL
)
}
\arguments{
\item{dfcounting}{List output from \code{df_counting} containing risk sets, event counts, and survival estimates.}

\item{scheme}{Character string specifying weighting scheme. One of:
\"fh\" (Fleming-Harrington), \"schemper\", \"XO\", \"MB\", \"custom_time\", or \"custom_code\".}

\item{tzero}{Time point at which to evaluate the difference in survival (default: 24).}

\item{rho}{Numeric weighting parameter (used for \"fh\" and \"custom_code\" schemes).}

\item{gamma}{Numeric weighting parameter (used for \"fh\" and \"custom_code\" schemes).}

\item{Scensor}{Optional numeric vector of censoring probabilities (for \"schemper\" scheme).}

\item{Ybar}{Optional numeric vector of risk set sizes (for \"XO\" scheme).}

\item{tpoints}{Optional numeric vector of time points (for \"custom_time\" and \"MB\" schemes).}

\item{t.tau}{Optional time cutoff for \"custom_time\" weights.}

\item{w0.tau, }{w1.tau Weights before/after t.tau (for \"custom_time\" scheme).}

\item{mb_tstar}{Optional time for MB weights.}
}
\value{
A list with elements:
\item{lr}{Weighted log-rank test statistic.}
\item{sig2_lr}{Variance of the log-rank statistic.}
\item{dhat}{Difference in survival at \code{tzero}.}
\item{cov_wlr_dhat}{Covariance between log-rank and difference at \code{tzero}.}
\item{sig2_dhat}{Variance of the difference at \code{tzero}.}
\item{cor_wlr_dhat}{Correlation between log-rank and difference at \code{tzero}.}
}
\description{
Computes the weighted log-rank statistic, its variance, the difference in survival at a specified time (\code{tzero}),
the variance of the difference, their covariance, and correlation, using flexible time-dependent weights.
The weighting scheme is selected via the \code{scheme} argument and is calculated using \code{wt.rg.S}.
}
\details{
The weighting scheme is selected via the \code{scheme} argument and calculated using \code{wt.rg.S}.
Supports standard Fleming-Harrington, Schemper, XO (Xu & O'Quigley), MB (Maggir-Burman), custom time-based, and custom code weights.
}
